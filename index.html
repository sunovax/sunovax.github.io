<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SUNOVAX Charging</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;font-family:Poppins;margin:0;padding:0}
body{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:linear-gradient(135deg,#081821,#0e2a3b);
  color:#fff;
}
.box{
  width:380px;
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(16px);
  border-radius:26px;
  padding:30px;
  text-align:center;
}
.sun{
  width:220px;height:220px;
  margin:0 auto 15px;
  background:radial-gradient(circle,#ffd84d,#ffb703,transparent 65%);
  border-radius:50%;
}
h1{color:#ffd84d;font-size:36px}
p{opacity:.85;margin-bottom:25px}
.step{display:none}
.step.active{display:block}
input,button{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  margin-top:12px;
}
button{
  background:linear-gradient(135deg,#ffd84d,#ffb703);
  font-weight:600;
  cursor:pointer;
}
.info{
  margin-top:15px;
  background:rgba(0,0,0,.25);
  padding:15px;
  border-radius:14px;
}
</style>
</head>

<body>
<div class="box">

<div class="step active" id="s1">
  <div class="sun"></div>
  <h1>SUNOVAX</h1>
  <p>Smart â€¢ Clean â€¢ Renewable Energy</p>
  <button onclick="go(2)">Start Charging</button>
</div>

<div class="step" id="s2">
  <h3>Current Battery %</h3>
  <input id="cur" type="number" placeholder="Eg: 45">
  <button onclick="start()">Continue</button>
</div>

<div class="step" id="s3">
  <h3>Plug In ðŸ”Œ</h3>
  <div class="info" id="est"></div>
</div>

<div class="step" id="s4">
  <h3>Thank You ðŸŒž</h3>
  <div class="info">
    Charging started successfully.<br>
    Thank you for choosing <b>SUNOVAX</b>.
  </div>
</div>

</div>

<script type="module">
import {initializeApp} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import {getFirestore,collection,addDoc,doc,onSnapshot} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const app=initializeApp({
  apiKey:"AIzaSyBYWFWFQaJZ-i4GU12tlCvLNjfY1s3aeJQ",
  projectId:"sunovax"
});
const db=getFirestore(app);

let sessionRef;

window.go=n=>{
  document.querySelectorAll(".step").forEach(s=>s.classList.remove("active"));
  document.getElementById("s"+n).classList.add("active");
};

window.start=async()=>{
  const cur=+curInput.value;
  if(isNaN(cur)||cur>=100) return alert("Invalid value");

  const mins=100-cur;

  sessionRef=await addDoc(collection(db,"sessions"),{
    created:Date.now(),
    duration:mins*60,
    charging:false
  });

  est.innerHTML=`Estimated Time: <b>${mins} minutes</b>`;
  go(3);

  onSnapshot(doc(db,"sessions",sessionRef.id),snap=>{
    if(!snap.exists()) location.reload();
    if(snap.data().charging) setTimeout(()=>go(4),3000);
  });
};

const curInput=document.getElementById("cur");
const est=document.getElementById("est");
</script>
</body>
</html>
