<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SUNOVAX Charging Station</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  color:white;
  background:
    radial-gradient(circle at top, rgba(255,215,100,0.35), transparent 60%),
    linear-gradient(135deg,#0b1f2a,#0e2a3b,#081821);
  overflow:hidden;
}

/* BIG SUN / LOGO */
.sun{
  position:absolute;
  top:-180px;
  width:480px;
  height:480px;
  background:radial-gradient(circle,#ffd84d,#ffb703,transparent 65%);
  border-radius:50%;
  animation:pulse 4s infinite;
  z-index:1;
}
@keyframes pulse{0%,100%{transform:scale(1);}50%{transform:scale(1.08);}}

/* Container */
.container{
  position:relative;
  z-index:2;
  width:100%;
  max-width:420px;
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(16px);
  border-radius:24px;
  padding:32px;
  text-align:center;
  box-shadow:0 25px 50px rgba(0,0,0,0.4);
}

h1{font-size:34px;color:#ffd84d;margin-bottom:6px;}
h2{font-size:16px;opacity:0.85;margin-bottom:24px;}

.step{display:none;opacity:0;transition:.5s;}
.step.active{display:block;opacity:1;}

input{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  margin-top:10px;
  font-size:15px;
}

.btn{
  margin-top:18px;
  padding:14px;
  width:100%;
  border:none;
  border-radius:14px;
  background:linear-gradient(135deg,#ffd84d,#ffb703);
  font-weight:600;
  font-size:16px;
  cursor:pointer;
}

.info{
  margin-top:16px;
  background:rgba(0,0,0,0.25);
  padding:16px;
  border-radius:14px;
}
</style>
</head>

<body>

<div class="sun"></div>

<div class="container">

<!-- STEP 1 -->
<div class="step active" id="s1">
  <h1>SUNOVAX</h1>
  <h2>Smart â€¢ Clean â€¢ Renewable Energy</h2>
  <button class="btn" onclick="go(2)">Start Charging</button>
</div>

<!-- STEP 2 -->
<div class="step" id="s2">
  <h1>Battery Level</h1>
  <input type="number" id="current" placeholder="Current %">
  <button class="btn" onclick="calc()">Continue</button>
</div>

<!-- STEP 3 -->
<div class="step" id="s3">
  <h1>Plug In ðŸ”Œ</h1>
  <div class="info" id="amountBox"></div>
</div>

<!-- STEP 4 -->
<div class="step" id="s4">
  <h1>Thank You ðŸŒž</h1>
  <div class="info">
    Charging started using clean energy.<br>
    Thank you for choosing SUNOVAX.
  </div>
</div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import {
  getFirestore,
  doc,
  setDoc,
  onSnapshot,
  deleteDoc
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBYWFWFQaJZ-i4GU12tlCvLNjfY1s3aeJQ",
  authDomain: "sunovax.firebaseapp.com",
  projectId: "sunovax"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const sessionId = "sess_" + Date.now();

window.go = n=>{
  document.querySelectorAll(".step").forEach(s=>s.classList.remove("active"));
  document.getElementById("s"+n).classList.add("active");
};

window.calc = async ()=>{
  const current = +document.getElementById("current").value;
  if(isNaN(current)||current>=100) return alert("Enter valid %");

  go(3);
  document.getElementById("amountBox").innerHTML =
    `Amount to Pay: <b>â‚¹100</b>`;

  await setDoc(doc(db,"sessions",sessionId),{
    paid:true,
    adminApproved:false,
    charging:false,
    created:Date.now()
  });

  onSnapshot(doc(db,"sessions",sessionId),snap=>{
    if(snap.exists() && snap.data().charging){
      setTimeout(()=>go(4),3000);

      // AUTO DELETE AFTER 30s
      setTimeout(async ()=>{
        await deleteDoc(doc(db,"sessions",sessionId));
      },30000);
    }
  });
};
</script>

</body>
</html>
